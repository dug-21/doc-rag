# RabbitMQ configuration for Doc-RAG system

# Network and clustering
listeners.tcp.default = 5672
management.tcp.port = 15672
management.tcp.ip = 0.0.0.0

# Enable management plugin
management.load_definitions = true

# Logging
log.console = true
log.console.level = info
log.file = false

# Memory and disk settings
vm_memory_high_watermark.relative = 0.8
disk_free_limit.relative = 2.0

# Connection settings
heartbeat = 60
frame_max = 131072
channel_max = 2047
connection_max = 1000

# Queue settings
default_vhost = /docrag
default_user = docrag
default_pass = rabbitmq_secret_2024
default_permissions.configure = .*
default_permissions.read = .*
default_permissions.write = .*

# Clustering (for multi-node setup)
cluster_formation.peer_discovery_backend = rabbit_peer_discovery_classic_config
cluster_formation.classic_config.nodes.1 = rabbit@rabbitmq

# High availability
queue_master_locator = min-masters

# Performance tuning
tcp_listen_options.backlog = 128
tcp_listen_options.nodelay = true
tcp_listen_options.linger.on = true
tcp_listen_options.linger.timeout = 0
tcp_listen_options.sndbuf = 196608
tcp_listen_options.recbuf = 196608

# Message persistence
queue_index_embed_msgs_below = 4096
msg_store_file_size_limit = 16777216

# Federation and shovel plugins (if needed)
# management.load_definitions = /etc/rabbitmq/definitions.json

# Prometheus metrics
prometheus.tcp.port = 15692
prometheus.tcp.ip = 0.0.0.0
prometheus.path = /metrics
prometheus.format = prometheus_text

# Auth backends
auth_backends.1 = rabbit_auth_backend_internal

# TLS configuration (disabled by default)
# ssl_options.verify = verify_peer
# ssl_options.fail_if_no_peer_cert = true
# ssl_options.cacertfile = /etc/ssl/certs/ca-cert.pem
# ssl_options.certfile = /etc/ssl/certs/server-cert.pem
# ssl_options.keyfile = /etc/ssl/private/server-key.pem